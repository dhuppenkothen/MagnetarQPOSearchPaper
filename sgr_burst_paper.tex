
\documentclass[numberedappendix]{emulateapj}

\newcommand{\ha}{H$\alpha$}

\usepackage{multirow}
\usepackage{graphicx}
\usepackage{rotating}
\usepackage{color}
%\usepackage{siunitx}
%\let\siunitx\relax
\newcommand{\com}[1]{\noindent\textcolor{red}{#1}}
\shorttitle{Timing analysis of SGR J1550-5418}
\shortauthors{Huppenkothen et al.}

\begin{document}

\title{Quasi-Periodic Oscillations in Short Recurring Bursts of the Soft Gamma Repeaters SGR 1806-20 and SGR 1900+14 Observed With RXTE}

\author{D. Huppenkothen\altaffilmark{1, 2}, Lucy Heil\altaffilmark{1}, A. L. Watts\altaffilmark{1},  E. G{\"o}{\u g}{\"u}{\c s}\altaffilmark{3}, Y. Kaneko\altaffilmark{3}}

 
\altaffiltext{1}{Astronomical Institute ``Anton Pannekoek'', University of
  Amsterdam, Postbus 94249, 1090 GE Amsterdam, the Netherlands}
\altaffiltext{2}{Email: D.Huppenkothen@uva.nl}

\altaffiltext{3}{Sabanc\i~University, Orhanl\i-Tuzla, \.Istanbul  34956, Turkey}

\begin{abstract}
This is an abstract. 
\end{abstract}
\begin{abstract}
\end{abstract} 

\keywords{pulsars: individual (SGR 1806-20, SGR 1800+14), stars: magnetic fields, stars: neutron, X-rays: bursts, methods:statistics}


\section{Introduction}

\section{Data}
\label{sec:data}

We extracted data from the two strongest-field magnetars, SGR 1806-20 and SGR 1900+14, observed with the Proportional Counter Array (PCA) onboard the {\it Rossi} X-ray Timing Explorer (RXTE). SGR 1806-20 was observed during an active period in 1998 (observation IDs 20165 and 10223), SGR 1900+14 during an active period in 1996 (observation ID 30410). These active periods were chosen both for the large number of bursts within a relatively small time interval, as well as for the quality of the observations, with all five detector units (PCUs) in operation for most of the bursts, which allows us to detect even weak bursts.

[Lucy inserts data processing here.]



We use burst start times and durations ($T_{90}$ i.e. the time around the peak count rate in which 90\% of all photons arrive at the detector) from \citet{gogus1999} and \citet{gogus2000}. 

Following \citet{zhang1995} and \citet{jahoda2006}, we correct the periodograms of the bursts for dead time effects. Dead time occurs when the X-ray detector is momentarily unresponsive after a photon impinged on it. In RXTE, there are two main types of dead time: (1) dead time after arrival of a photon, where the channel in which the photon arrived is paralysed for $10\mu\mathrm{s}$, and (2) dead time after a very large events (VLE), a photon with an energy much higher than the dynamic range of the detector, which saturates the amplifier. The latter paralyses the detector for $170\mu\mathrm{s}$. While both effects operate on very short timescales, much shorter than the timescales of interest here, the resulting loss of photons modifies the distribution of photon arrivals away from a Poisson distribution, and consequently also modifies the distribution of powers in the periodogram. Note that dead time depends very strongly on count rate: the brighter a source, the stronger the effect on the periodogram. Thus, dead time corrections are especially important for the brightest bursts, however, since the effects become appreciable even at moderate count rates of $\sim 2000 \,\mathrm{counts}\,\mathrm{s}^{-1}$, virtually all bursts need to be corrected. We use equations (10) and (13) of \citet{jahoda2006} to correct for dead time. The corrections are defined per PCU, whereas we use light curves combined from all active units in our analysis. Thus, the given normalisation constants are incorrect; we fit for these constants using a Maximum Likelihood approach, and correct for the resulting deviation in both noise level and periodogram shape. 


\section{Analysis Methods}
\label{sec:analysis}

Magnetar bursts, by their very nature, have a well-defined start and end. From this immediately follows that they are non-stationary processes and, as such, require special care when performing Fourier analysis - a decomposition into stationary sine functions - on their light curves. Note that stationarity does not imply a constant light curve: it merely implies that the variance in the light curve over any given time interval must be the same as over any other interval. 
Here, we use the Bayesian periodogram methods described in \citet{huppenkothen13} to deal with the effects of non-stationarity at low frequencies. In short, we compute the periodogram of a light curve with a high time resolution, here $dt = 0.5/2048 = 2.44 \times 10^{-4} \, \mathrm{s}$, which allows us to search up to a Nyquist frequency of $\nu_{\mathrm{Nyquist}} = 2048 \, \mathrm{Hz}$. For light curves that obey stationarity over the time scales of interest, standard Fourier methodology applies, and the statistical distributions of the resulting power spectra are well known. The bursty nature of our light curves introduces high variance at long time scales, correspondingly the periodogram shows high power at low frequencies. We model this power with an empirical function; experience has shown that simple or broken power laws can model a large range of burst phenomena. Consequently, we perform two tasks: (1) a model selection task, to ascertain whether the periodogram may be represented by a simple power law, or requires a more complex model; (2) a QPO search task, where we compare the maximum powers of a large number of simulations to the maximum power after dividing out the best-fit broadband model in the observed periodogram. For the model selection task, we fit the periodogram with both a simple and a broken power law and compute the likelihood ratio. We then sample from the posterior distribution of the simpler model via Markov Chain Monte Carlo, and simulate periodograms from draws of that posterior distribution. These periodograms are again fit with both models, such that we can build a distribution of likelihood ratios for realisations of the simpler model. This allows us to compute a posterior p-value, such that we can accept or reject the simple model. Here, we use a fairly conservative strategy and set the rejection threshold at $p = 0.05$, such that we prefer to over-fit the broadband noise, rather than mis-attribute noise components as a QPO.
In the second step, we draw from the posterior distribution of the model chosen in the model selection step, again via MCMC, and create a large number of simulated periodograms from these draws. We fit each periodogram with the preferred model, and find the highest data/model outlier. We can then compare the distribution of data/model outliers as derived from the simulations of broadband noise only with the highest data/model outlier in the observed periodogram. If the observed value is very unlikely given p-value derived from these simulations, one may say with relative confidence that we have detected a QPO at the frequency of the highest data/model outlier in the data. Note that while this approach automatically corrects for the fact that we have searched over a broad range of frequencies, we still need to correct for the fact that we also have searched over a large number of bursts: the more frequencies or bursts one searches, the likelier it becomes to see an outlier purely by chance. 

For details on the analysis procedure, including extensive simulations on simulated bursts, as well as the limitations of the method, see \citet{huppenkothen13} and \citet{vaughan2010}.


\subsection{Simulating Light Curves with Few Photons}

As a first step, we simulate simple, stationary (flat) light curves with similar characteristics as the observed bursts: short duration ($T_{90} < 1 \, \mathrm{s}$), high time resolution ($dt = 0.5/2048 \, \mathrm{s} = 2.44\times 10^{-4} \, \mathrm{s}$) and low numbers of photons (between 100 and 10000 photons per burst). 
We produce a large number of simulated light curves for different values of the total number of photons per light curve, in order to test how a low photon count rate affects the periodogram. We space the total photon count $N_{\mathrm{tot}}$ logarithmically, and simulate for $N_{\mathrm{tot}} = [100, 200, 500, 1000, 2000, 5000, 10000]$ in the following way, keeping all other parameters (e.g. burst duration and time resolution) the same:

(1) For a given total number of photons, we compute the expected number of counts per time bin. 
(2) We simulate $n_{\mathrm{sim}} = 10000$ light curves from the computed count rate by picking from a Poisson distribution with a mean equal to the count rate for each time bin. For low count rates, this will result in a large number of bins with no photons. The integrated number of photons in each light curve will not be $N_{\mathrm{tot}}$ exactly, but fall on a distribution around that value.
(3) For each simulated light curve, we create the periodogram and pick the maximum of the resulting powers. We then bin the periodogram at different bin factors representative of those chosen for the SGR burst light curves ($b = [1, 5, 10, 20, 50]$). Again, from each periodogram, we pick the highest power.
(4) In order to compare the distribution of maximum powers with theoretical predictions, we simulate the same number of powers as in the unbinned and binned periodograms created in (3) from a $\chi^2$-distribution with $2$ degrees of freedom, $P \sim \chi^2_2$, as expected for periodograms of pure white noise (flat, Poisson-distributed light curve). For the binned periodograms, the powers are still distributed as a $\chi^2$-distribution, now with $2b$ degrees of freedom, and scaled by b: $P \sim \chi^2_{2b}/b$.
(5) Finally, we compare the resulting distributions of maximum powers from the theoretically expected distributions and the distributions of maximum powers from the periodograms derived from simulated light curves using a 2-sided Kolmogorov-Smirnov test. 

\subsection{Light Curve Simulations of Candidate Detections}

In order to test a more realistic model, we simulate burst light curves from simple shapes. We model a burst as a single spike or a superposition of spikes of the form

\begin{equation}
\phi(t) = A \left\{\begin{array}{ll}\exp(t/\sigma) & \mbox{for $t<t_\mathrm{max}$}\\ \exp(-t/(\sigma s) & \mbox{for $t\geq t_{\mathrm{max}}$}\end{array}\right. \, ,
\end{equation}

where $A$ is the amplitude of a spike, $\sigma$ the rise time, $t_\mathrm{max}$ the location in time of the spike maximum, and $s$ a skewness parameter that sets how the decay time is stretched ($s > 1$) or contracted ($s < 1$) compared to the rise time. 



\section{Results}
\label{sec:results}



\section{Discussion}
\label{sec:discussion}

\section{Conclusions}


\acknowledgments
D.H. and ALW acknowledge support from a Netherlands Organization for Scientific Research (NWO) Vidi Fellowship (PI A. Watts).  


\bibliography{sgr_bursts_references}
\bibliographystyle{apj}





\end{document}
